<%- include('../layouts/main', { body: `
<div class="available-page">
    <div class="container">
        <div class="page-header">
            <h1>Available Players</h1>
            <p class="page-subtitle">Find golfers looking for a game</p>
        </div>

        <div class="page-actions">
            <a href="/availability/create" class="btn btn-primary">Set Your Availability</a>
        </div>

        <div class="filters-bar">
            <form action="/available" method="GET" class="filters-form">
                <div class="filter-group">
                    <input type="date" name="date" value="${filters.date || ''}" placeholder="Any date">
                </div>
                <div class="filter-group">
                    <select name="area">
                        <option value="">All Areas</option>
                        <option value="nice" ${filters.area === 'nice' ? 'selected' : ''}>Nice</option>
                        <option value="cannes" ${filters.area === 'cannes' ? 'selected' : ''}>Cannes</option>
                        <option value="monaco" ${filters.area === 'monaco' ? 'selected' : ''}>Monaco</option>
                        <option value="saint-tropez" ${filters.area === 'saint-tropez' ? 'selected' : ''}>Saint-Tropez</option>
                    </select>
                </div>
                <div class="filter-group">
                    <select name="time_window">
                        <option value="">Any Time</option>
                        <option value="early_bird" ${filters.time_window === 'early_bird' ? 'selected' : ''}>Early Bird</option>
                        <option value="morning" ${filters.time_window === 'morning' ? 'selected' : ''}>Morning</option>
                        <option value="afternoon" ${filters.time_window === 'afternoon' ? 'selected' : ''}>Afternoon</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-outline">Filter</button>
                ${(filters.date || filters.area || filters.time_window) ? '<a href="/available" class="btn btn-outline">Clear</a>' : ''}
            </form>
        </div>

        <div class="players-grid">
            ${availablePlayers && availablePlayers.length > 0 ?
                availablePlayers.map(avail => `
                    <article class="player-card">
                        <div class="player-card-header">
                            ${avail.profile_photo ?
                                `<img src="${avail.profile_photo}" alt="" class="player-photo">` :
                                `<span class="player-photo-placeholder">${avail.display_name.charAt(0)}</span>`
                            }
                            <div class="player-basic">
                                <h3><a href="/profile/${avail.user_id}">${avail.display_name}</a></h3>
                                <p class="player-location">
                                    ${avail.nationality || ''}
                                    ${avail.handicap ? ` Â· HCP ${avail.handicap}` : ''}
                                </p>
                            </div>
                        </div>
                        <div class="player-card-body">
                            <div class="availability-info">
                                <div class="avail-date">
                                    <span class="avail-label">Available</span>
                                    <span class="avail-value">${new Date(avail.available_date).toLocaleDateString('en-GB', { weekday: 'short', day: 'numeric', month: 'short' })}</span>
                                </div>
                                <div class="avail-time">
                                    <span class="avail-label">Time</span>
                                    <span class="avail-value">${avail.time_window.replace('_', ' ')}</span>
                                </div>
                            </div>
                            ${avail.course_name ? `<p class="avail-course">Prefers: ${avail.course_name}</p>` : ''}
                            ${avail.area ? `<p class="avail-area">Area: ${avail.area}</p>` : ''}
                            ${avail.note ? `<p class="avail-note">"${avail.note}"</p>` : ''}
                            <div class="player-tags">
                                ${avail.playing_level ? `<span class="tag">${avail.playing_level}</span>` : ''}
                                ${avail.languages && avail.languages.length > 0 ? avail.languages.map(l => `<span class="tag">${l}</span>`).join('') : ''}
                            </div>
                        </div>
                        <div class="player-card-footer">
                            <a href="/profile/${avail.user_id}" class="btn btn-outline btn-sm">View Profile</a>
                            ${user ? `
                                <a href="/games/create" class="btn btn-primary btn-sm">Invite to Game</a>
                            ` : ''}
                        </div>
                    </article>
                `).join('') :
                `<div class="empty-state full-width">
                    <p>No available players found for these criteria.</p>
                    <a href="/availability/create" class="btn btn-primary">Set Your Availability</a>
                </div>`
            }
        </div>
    </div>
</div>

<style>
.available-page { padding: var(--spacing-2xl) 0; }
.page-actions { margin-bottom: var(--spacing-xl); }
.players-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--spacing-lg); }
.player-card { background: white; border: 1px solid var(--color-border); border-radius: var(--radius-lg); overflow: hidden; }
.player-card-header { display: flex; align-items: center; gap: var(--spacing-md); padding: var(--spacing-lg); background: var(--color-bg-alt); }
.player-photo { width: 56px; height: 56px; border-radius: 50%; object-fit: cover; }
.player-photo-placeholder { width: 56px; height: 56px; border-radius: 50%; background: var(--color-primary); color: white; display: flex; align-items: center; justify-content: center; font-size: 1.25rem; font-weight: 600; }
.player-basic h3 { margin-bottom: 0; font-size: 1rem; }
.player-basic h3 a { color: inherit; }
.player-location { font-size: 0.875rem; color: var(--color-text-muted); margin: 0; }
.player-card-body { padding: var(--spacing-lg); }
.availability-info { display: flex; gap: var(--spacing-lg); margin-bottom: var(--spacing-md); }
.avail-label { display: block; font-size: 0.75rem; color: var(--color-text-muted); text-transform: uppercase; }
.avail-value { font-weight: 500; text-transform: capitalize; }
.avail-course, .avail-area { font-size: 0.875rem; color: var(--color-text-muted); margin-bottom: var(--spacing-sm); }
.avail-note { font-style: italic; color: var(--color-text-muted); font-size: 0.875rem; margin-bottom: var(--spacing-md); }
.player-tags { display: flex; flex-wrap: wrap; gap: var(--spacing-xs); }
.player-card-footer { padding: var(--spacing-md) var(--spacing-lg); border-top: 1px solid var(--color-border); display: flex; gap: var(--spacing-sm); }
.full-width { grid-column: 1 / -1; }
@media (max-width: 1024px) { .players-grid { grid-template-columns: repeat(2, 1fr); } }
@media (max-width: 768px) { .players-grid { grid-template-columns: 1fr; } }
</style>
` }) %>
